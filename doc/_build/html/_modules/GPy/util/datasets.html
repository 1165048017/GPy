<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GPy.util.datasets &mdash; GPy  documentation</title>
    
    <link rel="stylesheet" href="../../../_static//default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="GPy  documentation" href="../../../index.html" />
    <link rel="up" title="GPy" href="../../GPy.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">GPy  documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../GPy.html" accesskey="U">GPy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for GPy.util.datasets</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">GPy</span>
<span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="kn">import</span> <span class="nn">cPickle</span> <span class="kn">as</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">ipython_available</span><span class="o">=</span><span class="bp">True</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">IPython</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">ipython_available</span><span class="o">=</span><span class="bp">False</span>


<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">urllib2</span>

<div class="viewcode-block" id="reporthook"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.reporthook">[docs]</a><span class="k">def</span> <span class="nf">reporthook</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="c"># &#39;,&#39; at the end of the line is important!</span>
    <span class="c">#print &quot;% 3.1f%% of %d bytes\r&quot; % (min(100, float(a * b) / c * 100), c),</span>
    <span class="c">#you can also use sys.stdout.write</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="si">% 3.1f%%</span><span class="s"> of </span><span class="si">%d</span><span class="s"> bytes&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span> <span class="n">c</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="c"># Global variables</span></div>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;datasets&#39;</span><span class="p">,</span> <span class="s">&#39;dir&#39;</span><span class="p">))</span>
<span class="c">#data_path = os.path.join(os.path.dirname(__file__), &#39;datasets&#39;)</span>
<span class="n">default_seed</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">overide_manual_authorize</span><span class="o">=</span><span class="bp">False</span>
<span class="n">neil_url</span> <span class="o">=</span> <span class="s">&#39;http://staffwww.dcs.shef.ac.uk/people/N.Lawrence/dataset_mirror/&#39;</span>

<span class="c"># Read data resources from json file.</span>
<span class="c"># Don&#39;t do this when ReadTheDocs is scanning as it breaks things</span>
<span class="n">on_rtd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;READTHEDOCS&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;True&#39;</span> <span class="c">#Checks if RTD is scanning</span>

<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">on_rtd</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s">&#39;data_resources.json&#39;</span><span class="p">)</span>
    <span class="n">json_data</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">data_resources</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">on_rtd</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s">&#39;football_teams.json&#39;</span><span class="p">)</span>
    <span class="n">json_data</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">football_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>



<div class="viewcode-block" id="prompt_user"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.prompt_user">[docs]</a><span class="k">def</span> <span class="nf">prompt_user</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ask user for agreeing to data set licenses.&quot;&quot;&quot;</span>
    <span class="c"># raw_input returns the empty string for &quot;enter&quot;</span>
    <span class="n">yes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">no</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&#39;no&#39;</span><span class="p">,</span><span class="s">&#39;n&#39;</span><span class="p">])</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="c"># would like to test for exception here, but not sure if we can do that without importing IPython</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Stdin is not implemented.&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;You need to set&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;overide_manual_authorize=True&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;to proceed with the download. Please set that variable and continue.&#39;</span><span class="p">)</span>
        <span class="k">raise</span>


    <span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">yes</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">no</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Your response was a &quot;</span> <span class="o">+</span> <span class="n">choice</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Please respond with &#39;yes&#39;, &#39;y&#39; or &#39;no&#39;, &#39;n&#39;&quot;</span><span class="p">)</span>
        <span class="c">#return prompt_user()</span>

</div>
<div class="viewcode-block" id="data_available"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.data_available">[docs]</a><span class="k">def</span> <span class="nf">data_available</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if the data set is available on the local machine already.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip_longest</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">data_resources</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="n">zip_urls</span> <span class="o">=</span> <span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;files&#39;</span><span class="p">],</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">dr</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;save_names&#39;</span><span class="p">):</span> <span class="n">zip_urls</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;save_names&#39;</span><span class="p">],</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">zip_urls</span> <span class="o">+=</span> <span class="p">([],)</span>

    <span class="k">for</span> <span class="n">file_list</span><span class="p">,</span> <span class="n">save_list</span> <span class="ow">in</span> <span class="n">izip_longest</span><span class="p">(</span><span class="o">*</span><span class="n">zip_urls</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">izip_longest</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="n">save_list</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="n">f</span><span class="o">=</span><span class="n">s</span> <span class="c"># If there is a save_name given, use that one</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">f</span><span class="p">)):</span>
                <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="download_url"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.download_url">[docs]</a><span class="k">def</span> <span class="nf">download_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">store_directory</span><span class="p">,</span> <span class="n">save_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">messages</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download a file from a url and save it to disk.&quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">print</span> <span class="nb">file</span>
    <span class="n">dir_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">store_directory</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">save_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">save_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="n">save_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">suffix</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">suffix</span><span class="o">=</span><span class="s">&#39;&#39;</span>

    <span class="k">print</span> <span class="s">&quot;Downloading &quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="s">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">save_name</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dir_name</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">suffix</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s">&quot;code&quot;</span><span class="p">):</span>
            <span class="k">raise</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">e</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">&gt;</span> <span class="mi">399</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="o">&lt;</span><span class="mi">500</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Tried url &#39;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="n">suffix</span> <span class="o">+</span> <span class="s">&#39; and received client error &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">code</span> <span class="o">&gt;</span> <span class="mi">499</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Tried url &#39;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="n">suffix</span> <span class="o">+</span> <span class="s">&#39; and received server error &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
        <span class="n">content_length_str</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">getheaders</span><span class="p">(</span><span class="s">&quot;Content-Length&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">content_length_str</span><span class="p">:</span>
            <span class="n">file_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">content_length_str</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_size</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">file_size_dl</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">block_sz</span> <span class="o">=</span> <span class="mi">8192</span>
        <span class="n">line_length</span><span class="o">=</span><span class="mi">30</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">buff</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">block_sz</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">buff</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">file_size_dl</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buff</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">buff</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file_size</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="s">r&quot;[{perc: &lt;{ll}}] {dl:7.3f}/{full:.3f}MB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">file_size_dl</span><span class="o">/</span><span class="p">(</span><span class="mf">1048576.</span><span class="p">),</span>
                                                                       <span class="n">full</span><span class="o">=</span><span class="n">file_size</span><span class="o">/</span><span class="p">(</span><span class="mf">1048576.</span><span class="p">),</span> <span class="n">ll</span><span class="o">=</span><span class="n">line_length</span><span class="p">,</span>
                                                                       <span class="n">perc</span><span class="o">=</span><span class="s">&quot;=&quot;</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">line_length</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">file_size_dl</span><span class="p">)</span><span class="o">/</span><span class="n">file_size</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="s">r&quot;[{perc: &lt;{ll}}] {dl:7.3f}MB&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">file_size_dl</span><span class="o">/</span><span class="p">(</span><span class="mf">1048576.</span><span class="p">),</span>
                                                                       <span class="n">ll</span><span class="o">=</span><span class="n">line_length</span><span class="p">,</span>
                                                                       <span class="n">perc</span><span class="o">=</span><span class="s">&quot;.&quot;</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">line_length</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">file_size_dl</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mf">1048576.</span><span class="p">))))</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">))</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">status</span>
    <span class="c"># if we wanted to get more sophisticated maybe we should check the response code here again even for successes.</span>
    <span class="c">#with open(save_name, &#39;wb&#39;) as f:</span>
    <span class="c">#    f.write(response.read())</span>

    <span class="c">#urllib.urlretrieve(url+suffix, save_name, reporthook)</span>
</div>
<div class="viewcode-block" id="authorize_download"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.authorize_download">[docs]</a><span class="k">def</span> <span class="nf">authorize_download</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check with the user that the are happy with terms and conditions for the data set.&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Acquiring resource: &#39;</span> <span class="o">+</span> <span class="n">dataset_name</span><span class="p">)</span>
    <span class="c"># TODO, check resource is in dictionary!</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">data_resources</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Details of data: &#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;details&#39;</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dr</span><span class="p">[</span><span class="s">&#39;citation&#39;</span><span class="p">]:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Please cite:&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;citation&#39;</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dr</span><span class="p">[</span><span class="s">&#39;size&#39;</span><span class="p">]:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;After downloading the data will take up &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;size&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39; bytes of space.&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Data will be stored in &#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">overide_manual_authorize</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dr</span><span class="p">[</span><span class="s">&#39;license&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;You have agreed to the following license:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;license&#39;</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dr</span><span class="p">[</span><span class="s">&#39;license&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;You must also agree to the following license:&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;license&#39;</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prompt_user</span><span class="p">(</span><span class="s">&#39;Do you wish to proceed with the download? [yes/no]&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="download_data"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.download_data">[docs]</a><span class="k">def</span> <span class="nf">download_data</span><span class="p">(</span><span class="n">dataset_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check with the user that the are happy with terms and conditions for the data set, then download it.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">itertools</span>

    <span class="n">dr</span> <span class="o">=</span> <span class="n">data_resources</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">authorize_download</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Permission to download data set denied.&quot;</span><span class="p">)</span>

    <span class="n">zip_urls</span> <span class="o">=</span> <span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;urls&#39;</span><span class="p">],</span> <span class="n">dr</span><span class="p">[</span><span class="s">&#39;files&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dr</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;save_names&#39;</span><span class="p">):</span> <span class="n">zip_urls</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;save_names&#39;</span><span class="p">],</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">zip_urls</span> <span class="o">+=</span> <span class="p">([],)</span>

    <span class="k">if</span> <span class="n">dr</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;suffices&#39;</span><span class="p">):</span> <span class="n">zip_urls</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="s">&#39;suffices&#39;</span><span class="p">],</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">zip_urls</span> <span class="o">+=</span> <span class="p">([],)</span>

    <span class="k">for</span> <span class="n">url</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">save_names</span><span class="p">,</span> <span class="n">suffices</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">izip_longest</span><span class="p">(</span><span class="o">*</span><span class="n">zip_urls</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">save_name</span><span class="p">,</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">izip_longest</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">save_names</span><span class="p">,</span> <span class="n">suffices</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="n">download_url</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">f</span><span class="p">),</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">save_name</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="data_details_return"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.data_details_return">[docs]</a><span class="k">def</span> <span class="nf">data_details_return</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_set</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update the data component of the data dictionary with details drawn from the data_resources.&quot;&quot;&quot;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data_resources</span><span class="p">[</span><span class="n">data_set</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data</span>

</div>
<div class="viewcode-block" id="cmu_urls_files"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.cmu_urls_files">[docs]</a><span class="k">def</span> <span class="nf">cmu_urls_files</span><span class="p">(</span><span class="n">subj_motions</span><span class="p">,</span> <span class="n">messages</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Find which resources are missing on the local disk for the requested CMU motion capture motions.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">data_resources</span><span class="p">[</span><span class="s">&#39;cmu_mocap_full&#39;</span><span class="p">]</span>
    <span class="n">cmu_url</span> <span class="o">=</span> <span class="n">dr</span><span class="p">[</span><span class="s">&#39;urls&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">subjects_num</span> <span class="o">=</span> <span class="n">subj_motions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">motions_num</span> <span class="o">=</span> <span class="n">subj_motions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">resource</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;urls&#39;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s">&#39;files&#39;</span> <span class="p">:</span> <span class="p">[]}</span>
    <span class="c"># Convert numbers to strings</span>
    <span class="n">subjects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">motions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects_num</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects_num</span><span class="p">)):</span>
        <span class="n">curSubj</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">subjects_num</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">subjects_num</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">curSubj</span> <span class="o">=</span> <span class="s">&#39;0&#39;</span> <span class="o">+</span> <span class="n">curSubj</span>
        <span class="n">subjects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curSubj</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">motions_num</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
            <span class="n">curMot</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">motions_num</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">motions_num</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">curMot</span> <span class="o">=</span> <span class="s">&#39;0&#39;</span> <span class="o">+</span> <span class="n">curMot</span>
            <span class="n">motions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curMot</span><span class="p">)</span>

    <span class="n">all_skels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">motions</span><span class="p">)</span>

    <span class="n">all_motions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)):</span>
        <span class="n">skel_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s">&#39;cmu_mocap&#39;</span><span class="p">)</span>
        <span class="n">cur_skel_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">skel_dir</span><span class="p">,</span> <span class="n">subjects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.asf&#39;</span><span class="p">)</span>

        <span class="n">url_required</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">file_download</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cur_skel_file</span><span class="p">):</span>
            <span class="c"># Current skel file doesn&#39;t exist.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">skel_dir</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">skel_dir</span><span class="p">)</span>
            <span class="c"># Add skel file to list.</span>
            <span class="n">url_required</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">file_download</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subjects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.asf&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">motions</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">motions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.amc&#39;</span>
            <span class="n">cur_motion_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">skel_dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cur_motion_file</span><span class="p">):</span>
                <span class="n">url_required</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">file_download</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subjects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">motions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.amc&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">url_required</span><span class="p">:</span>
            <span class="n">resource</span><span class="p">[</span><span class="s">&#39;urls&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmu_url</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">subjects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">resource</span><span class="p">[</span><span class="s">&#39;files&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_download</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resource</span>
</div>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">gpxpy</span>
    <span class="kn">import</span> <span class="nn">gpxpy.gpx</span>
    <span class="n">gpxpy_available</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">gpxpy_available</span> <span class="o">=</span> <span class="bp">False</span>

<span class="k">if</span> <span class="n">gpxpy_available</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">epomeo_gpx</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;epomeo_gpx&#39;</span><span class="p">,</span> <span class="n">sample_every</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
            <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;endomondo_1&#39;</span><span class="p">,</span> <span class="s">&#39;endomondo_2&#39;</span><span class="p">,</span> <span class="s">&#39;garmin_watch_via_endomondo&#39;</span><span class="p">,</span><span class="s">&#39;viewranger_phone&#39;</span><span class="p">,</span> <span class="s">&#39;viewranger_tablet&#39;</span><span class="p">]</span>

        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">gpx_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s">&#39;epomeo_gpx&#39;</span><span class="p">,</span> <span class="nb">file</span> <span class="o">+</span> <span class="s">&#39;.gpx&#39;</span><span class="p">),</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>

            <span class="n">gpx</span> <span class="o">=</span> <span class="n">gpxpy</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">gpx_file</span><span class="p">)</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="n">gpx</span><span class="o">.</span><span class="n">tracks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">gpx</span><span class="o">.</span><span class="n">tracks</span> <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">segments</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">points</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">point</span><span class="o">.</span><span class="n">time</span><span class="o">-</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">21</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">point</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">elevation</span><span class="p">]</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)[::</span><span class="n">sample_every</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">gpx_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span> <span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;info&#39;</span> <span class="p">:</span> <span class="s">&#39;Data is an array containing time in seconds, latitude, longitude and elevation in that order.&#39;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

<span class="c">#del gpxpy_available</span>



<span class="c"># Some general utilities.</span>
<div class="viewcode-block" id="sample_class"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.sample_class">[docs]</a><span class="k">def</span> <span class="nf">sample_class</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>
</div>
<div class="viewcode-block" id="boston_housing"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.boston_housing">[docs]</a><span class="k">def</span> <span class="nf">boston_housing</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;boston_housing&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;housing.data&#39;</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[:,</span> <span class="mi">13</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span> <span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="brendan_faces"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.brendan_faces">[docs]</a><span class="k">def</span> <span class="nf">brendan_faces</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;brendan_faces&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">mat_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;frey_rawface.mat&#39;</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;ff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="della_gatta_TRP63_gene_expression"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.della_gatta_TRP63_gene_expression">[docs]</a><span class="k">def</span> <span class="nf">della_gatta_TRP63_gene_expression</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;della_gatta&#39;</span><span class="p">,</span> <span class="n">gene_number</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">mat_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DellaGattadata.mat&#39;</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;timepoints&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">gene_number</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;exprs_tp53_RMA&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;exprs_tp53_RMA&#39;</span><span class="p">][:,</span> <span class="n">gene_number</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;gene_number&#39;</span> <span class="p">:</span> <span class="n">gene_number</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="football_data"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.football_data">[docs]</a><span class="k">def</span> <span class="nf">football_data</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s">&#39;1314&#39;</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="s">&#39;football_data&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Football data from English games since 1993. This downloads data from football-data.co.uk for the given season. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">league2num</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
        <span class="n">league_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;E0&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;E1&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;E2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;E3&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;EC&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">league_dict</span><span class="p">[</span><span class="n">string</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">football2num</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">football_dict</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">football_dict</span><span class="p">[</span><span class="n">string</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">football_dict</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">football_dict</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">football_dict</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">data_set_season</span> <span class="o">=</span> <span class="n">data_set</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">season</span>
    <span class="n">data_resources</span><span class="p">[</span><span class="n">data_set_season</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_resources</span><span class="p">[</span><span class="n">data_set</span><span class="p">])</span>
    <span class="n">data_resources</span><span class="p">[</span><span class="n">data_set_season</span><span class="p">][</span><span class="s">&#39;urls&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">season</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">season</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">end_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">season</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;E0.csv&#39;</span><span class="p">,</span> <span class="s">&#39;E1.csv&#39;</span><span class="p">,</span> <span class="s">&#39;E2.csv&#39;</span><span class="p">,</span> <span class="s">&#39;E3.csv&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">start_year</span><span class="o">&gt;</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">start_year</span> <span class="o">&lt;</span> <span class="mi">93</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;EC.csv&#39;</span><span class="p">]</span>
    <span class="n">data_resources</span><span class="p">[</span><span class="n">data_set_season</span><span class="p">][</span><span class="s">&#39;files&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">files</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set_season</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set_season</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">pb</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">files</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set_season</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
        <span class="c"># rewrite files removing blank rows.</span>
        <span class="n">writename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set_season</span><span class="p">,</span> <span class="s">&#39;temp.csv&#39;</span><span class="p">)</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">writename</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">row</span><span class="p">):</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="nb">input</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">writename</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">converters</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">league2num</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">pb</span><span class="o">.</span><span class="n">datestr2num</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="n">football2num</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="n">football2num</span><span class="p">},</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">table</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">table</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="sod1_mouse"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.sod1_mouse">[docs]</a><span class="k">def</span> <span class="nf">sod1_mouse</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;sod1_mouse&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;sod1_C57_129_exprs.csv&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">num_repeats</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">num_time</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">num_cond</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">X</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="spellman_yeast"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.spellman_yeast">[docs]</a><span class="k">def</span> <span class="nf">spellman_yeast</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;spellman_yeast&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;combined.txt&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="spellman_yeast_cdc15"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.spellman_yeast_cdc15">[docs]</a><span class="k">def</span> <span class="nf">spellman_yeast_cdc15</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;spellman_yeast&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;combined.txt&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">290</span><span class="p">])</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;cdc15_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">times</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span> <span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&#39;Time series of synchronized yeast cells from the CDC-15 experiment of Spellman et al (1998).&#39;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="lee_yeast_ChIP"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.lee_yeast_ChIP">[docs]</a><span class="k">def</span> <span class="nf">lee_yeast_ChIP</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;lee_yeast_ChIP&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="kn">import</span> <span class="nn">zipfile</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;binding_by_gene.tsv&#39;</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">transcription_factors</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;Unnamed&#39;</span><span class="p">]</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="n">S</span><span class="p">[[</span><span class="s">&#39;Unnamed: 1&#39;</span><span class="p">,</span> <span class="s">&#39;Unnamed: 2&#39;</span><span class="p">,</span> <span class="s">&#39;Unnamed: 3&#39;</span><span class="p">]]</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">transcription_factors</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;annotations&#39;</span> <span class="p">:</span> <span class="n">annotations</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span> <span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="s">&#39;transcription_factors&#39;</span><span class="p">:</span> <span class="n">transcription_factors</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="fruitfly_tomancak"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.fruitfly_tomancak">[docs]</a><span class="k">def</span> <span class="nf">fruitfly_tomancak</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;fruitfly_tomancak&#39;</span><span class="p">,</span> <span class="n">gene_number</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;tomancak_exprs.csv&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">num_repeats</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">num_time</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">xt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_time</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_time</span><span class="p">)</span>
    <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_repeats</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_repeats</span><span class="p">)</span>
    <span class="n">xtime</span><span class="p">,</span> <span class="n">xrepeat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">xr</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xtime</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">xrepeat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;gene_number&#39;</span> <span class="p">:</span> <span class="n">gene_number</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="drosophila_protein"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.drosophila_protein">[docs]</a><span class="k">def</span> <span class="nf">drosophila_protein</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;drosophila_protein&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;becker_et_al.csv&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="drosophila_knirps"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.drosophila_knirps">[docs]</a><span class="k">def</span> <span class="nf">drosophila_knirps</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;drosophila_protein&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;becker_et_al.csv&#39;</span><span class="p">)</span>
    <span class="c"># in the csv file we have facts_kni and ext_kni. We treat facts_kni as protein and ext_kni as mRNA</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][:,</span><span class="bp">None</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][:,</span><span class="bp">None</span><span class="p">]</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;expression1&#39;</span><span class="p">][:,</span><span class="bp">None</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;expression2&#39;</span><span class="p">][:,</span><span class="bp">None</span><span class="p">]</span>

    <span class="n">leng</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">])</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>
    <span class="n">inx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">leng</span><span class="o">*</span><span class="mi">2</span><span class="p">)[:,</span><span class="bp">None</span><span class="p">]</span>

    <span class="n">inx</span><span class="p">[</span><span class="n">leng</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">leng</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">T</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">inx</span><span class="p">])</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">g</span><span class="p">,</span><span class="n">p</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

<span class="c"># This will be for downloading google trends data.</span></div>
<div class="viewcode-block" id="google_trends"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.google_trends">[docs]</a><span class="k">def</span> <span class="nf">google_trends</span><span class="p">(</span><span class="n">query_terms</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;big data&#39;</span><span class="p">,</span> <span class="s">&#39;machine learning&#39;</span><span class="p">,</span> <span class="s">&#39;data science&#39;</span><span class="p">],</span> <span class="n">data_set</span><span class="o">=</span><span class="s">&#39;google_trends&#39;</span><span class="p">,</span> <span class="n">refresh_data</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data downloaded from Google trends for given query terms. Warning, if you use this function multiple times in a row you get blocked due to terms of service violations. The function will cache the result of your query, if you wish to refresh an old query set refresh_data to True. The function is inspired by this notebook: http://nbviewer.ipython.org/github/sahuguet/notebooks/blob/master/GoogleTrends%20meet%20Notebook.ipynb&quot;&quot;&quot;</span>
    <span class="n">query_terms</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="kn">import</span> <span class="nn">pandas</span>

    <span class="c"># Create directory name for data</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="s">&#39;google_trends&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
    <span class="n">dir_name</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">query_terms</span><span class="p">)</span>
    <span class="n">dir_name</span> <span class="o">=</span> <span class="n">dir_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">)</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="n">dir_name</span><span class="p">)</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="s">&#39;data.csv&#39;</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="nb">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="ow">or</span> <span class="n">refresh_data</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Accessing Google trends to acquire the data. Note that repeated accesses will result in a block due to a google terms of service violation. Failure at this point may be due to such blocks.&quot;</span>
        <span class="c"># quote the query terms.</span>
        <span class="n">quoted_terms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">quoted_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>
        <span class="k">print</span> <span class="s">&quot;Query terms: &quot;</span><span class="p">,</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">query_terms</span><span class="p">)</span>

        <span class="k">print</span> <span class="s">&quot;Fetching query:&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s">&#39;http://www.google.com/trends/fetchComponent?q=</span><span class="si">%s</span><span class="s">&amp;cid=TIMESERIES_GRAPH_0&amp;export=3&#39;</span> <span class="o">%</span> <span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quoted_terms</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">print</span> <span class="s">&quot;Done.&quot;</span>
        <span class="c"># In the notebook they did some data cleaning: remove Javascript header+footer, and translate new Date(....,..,..) into YYYY-MM-DD.</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;// Data table response</span><span class="se">\n</span><span class="s">google.visualization.Query.setResponse(&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">):</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;new Date\((\d+),(\d+),(\d+)\)&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="s">&#39;&quot;</span><span class="si">%s</span><span class="s">-</span><span class="si">%02d</span><span class="s">-</span><span class="si">%02d</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="mi">1</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)))),</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">timeseries</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">timeseries</span><span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">][</span><span class="s">&#39;cols&#39;</span><span class="p">]]</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s">&#39;v&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]],</span> <span class="n">timeseries</span><span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">][</span><span class="s">&#39;rows&#39;</span><span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dir_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>

        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Reading cached data for google trends. To refresh the cache set &#39;refresh_data=True&#39; when calling this function.&quot;</span>
        <span class="k">print</span> <span class="s">&quot;Query terms: &quot;</span><span class="p">,</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">query_terms</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">query_terms</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">datetime</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([(</span><span class="n">row</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">query_terms</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="p">])</span>
    <span class="n">output_info</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;data frame&#39;</span> <span class="p">:</span> <span class="n">df</span><span class="p">,</span> <span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;query_terms&#39;</span><span class="p">:</span> <span class="n">output_info</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Data downloaded from google trends with query terms: &quot;</span> <span class="o">+</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_info</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

<span class="c"># The data sets</span></div>
<div class="viewcode-block" id="oil"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.oil">[docs]</a><span class="k">def</span> <span class="nf">oil</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;three_phase_oil_flow&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The three phase oil data from Bishop and James (1993).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">oil_train_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DataTrn.txt&#39;</span><span class="p">)</span>
    <span class="n">oil_trainlbls_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DataTrnLbls.txt&#39;</span><span class="p">)</span>
    <span class="n">oil_test_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DataTst.txt&#39;</span><span class="p">)</span>
    <span class="n">oil_testlbls_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DataTstLbls.txt&#39;</span><span class="p">)</span>
    <span class="n">oil_valid_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DataVdn.txt&#39;</span><span class="p">)</span>
    <span class="n">oil_validlbls_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;DataVdnLbls.txt&#39;</span><span class="p">)</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">oil_train_file</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">oil_test_file</span><span class="p">)</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">oil_valid_file</span><span class="p">)</span>
    <span class="n">Xvalid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">oil_trainlbls_file</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">2.</span> <span class="o">-</span> <span class="mf">1.</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">oil_testlbls_file</span><span class="p">)</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">2.</span> <span class="o">-</span> <span class="mf">1.</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">oil_validlbls_file</span><span class="p">)</span>
    <span class="n">Yvalid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mf">2.</span> <span class="o">-</span> <span class="mf">1.</span>
    <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span> <span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Xvalid&#39;</span><span class="p">:</span> <span class="n">Xvalid</span><span class="p">,</span> <span class="s">&#39;Yvalid&#39;</span><span class="p">:</span> <span class="n">Yvalid</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="c">#else:</span>
    <span class="c"># throw an error</span>
</div>
<div class="viewcode-block" id="oil_100"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.oil_100">[docs]</a><span class="k">def</span> <span class="nf">oil_100</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">,</span> <span class="n">data_set</span> <span class="o">=</span> <span class="s">&#39;three_phase_oil_flow&#39;</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">oil</span><span class="p">()</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">][</span><span class="n">indices</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">][</span><span class="n">indices</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Subsample of the full oil data extracting 100 values randomly without replacement, here seed was &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">seed</span><span class="p">)},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="pumadyn"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.pumadyn">[docs]</a><span class="k">def</span> <span class="nf">pumadyn</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="s">&#39;pumadyn-32nm&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
        <span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;pumadyn-32nm.tar.gz&#39;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Extracting file.&#39;</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># Data is variance 1, no need to normalize.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;pumadyn-32nm&#39;</span><span class="p">,</span> <span class="s">&#39;Dataset.data.gz&#39;</span><span class="p">))</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">indicesTrain</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7168</span><span class="p">]</span>
    <span class="n">indicesTest</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">7168</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">indicesTrain</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">indicesTest</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indicesTrain</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indicesTrain</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indicesTest</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indicesTest</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;seed&#39;</span><span class="p">:</span> <span class="n">seed</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="robot_wireless"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.robot_wireless">[docs]</a><span class="k">def</span> <span class="nf">robot_wireless</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;robot_wireless&#39;</span><span class="p">):</span>
    <span class="c"># WiFi access point strengths on a tour around UW Paul Allen building.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;uw-floor.txt&#39;</span><span class="p">)</span>
    <span class="n">all_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">macaddress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;string&#39;</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">strength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">addresses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">macaddress</span><span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">all_time</span><span class="p">)</span>
    <span class="n">addresses</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">times</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">allY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">addresses</span><span class="p">)))</span>
    <span class="n">allX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">allY</span><span class="p">[:]</span><span class="o">=-</span><span class="mf">92.</span>
    <span class="n">strengths</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">address</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">addresses</span><span class="p">))):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">address</span><span class="o">==</span><span class="n">macaddress</span><span class="p">)</span>
        <span class="n">temp_strengths</span><span class="o">=</span><span class="n">strength</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">temp_x</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">temp_y</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">temp_times</span> <span class="o">=</span> <span class="n">all_time</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">temp_times</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">time</span><span class="o">==</span><span class="n">temp_times</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
                <span class="n">ind2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">time</span><span class="o">==</span><span class="n">times</span><span class="p">)</span>
                <span class="n">allY</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_strengths</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span>
                <span class="n">allX</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_x</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span>
                <span class="n">allX</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_y</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span>
    <span class="n">allY</span> <span class="o">=</span> <span class="p">(</span><span class="n">allY</span> <span class="o">+</span> <span class="mf">85.</span><span class="p">)</span><span class="o">/</span><span class="mf">15.</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">allX</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">215</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">allY</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">215</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">allX</span><span class="p">[</span><span class="mi">215</span><span class="p">:,</span> <span class="p">:]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">allY</span><span class="p">[</span><span class="mi">215</span><span class="p">:,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;addresses&#39;</span> <span class="p">:</span> <span class="n">addresses</span><span class="p">,</span> <span class="s">&#39;times&#39;</span> <span class="p">:</span> <span class="n">times</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="silhouette"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.silhouette">[docs]</a><span class="k">def</span> <span class="nf">silhouette</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;ankur_pose_data&#39;</span><span class="p">):</span>
    <span class="c"># Ankur Agarwal and Bill Trigg&#39;s silhoutte data.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">mat_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;ankurDataPoseSilhouette.mat&#39;</span><span class="p">))</span>
    <span class="n">inMean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">])</span>
    <span class="n">inScales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">]))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">inMean</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">inScales</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Y_test&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">inMean</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">Xtest</span> <span class="o">/</span> <span class="n">inScales</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Z_test&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="decampos_digits"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.decampos_digits">[docs]</a><span class="k">def</span> <span class="nf">decampos_digits</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;decampos_characters&#39;</span><span class="p">,</span> <span class="n">which_digits</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;digits.npy&#39;</span><span class="p">))</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[</span><span class="n">which_digits</span><span class="p">,:,:,:]</span>
    <span class="n">num_classes</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">digits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">digits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">digits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">digits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="n">num_samples</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">which_digits</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">str_lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)]</span><span class="o">*</span><span class="n">num_samples</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">which_digits</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;lbls&#39;</span><span class="p">:</span> <span class="n">lbls</span><span class="p">,</span> <span class="s">&#39;str_lbls&#39;</span> <span class="p">:</span> <span class="n">str_lbls</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&#39;Digits data set from the de Campos characters data&#39;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ripley_synth"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.ripley_synth">[docs]</a><span class="k">def</span> <span class="nf">ripley_synth</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;ripley_prnn_data&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;synth.tr&#39;</span><span class="p">),</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;synth.te&#39;</span><span class="p">),</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ytest</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">ytest</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&#39;Synthetic data generated by Ripley for a two class classification problem.&#39;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="global_average_temperature"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.global_average_temperature">[docs]</a><span class="k">def</span> <span class="nf">global_average_temperature</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;global_temperature&#39;</span><span class="p">,</span> <span class="n">num_train</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">refresh_data</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">refresh_data</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;Using cached version of the data set, to use latest version set refresh_data to True&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;GLBTS.long.data&#39;</span><span class="p">))</span>
    <span class="k">print</span> <span class="s">&#39;Most recent data observation from month &#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">&#39; in year &#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">allX</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mf">99.99</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">allY</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mf">99.99</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">allX</span><span class="p">[:</span><span class="n">num_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">allX</span><span class="p">[</span><span class="n">num_train</span><span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">allY</span><span class="p">[:</span><span class="n">num_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">allY</span><span class="p">[</span><span class="n">num_train</span><span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Mauna Loa data with &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_train</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; values used as training points.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="mauna_loa"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.mauna_loa">[docs]</a><span class="k">def</span> <span class="nf">mauna_loa</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;mauna_loa&#39;</span><span class="p">,</span> <span class="n">num_train</span><span class="o">=</span><span class="mi">545</span><span class="p">,</span> <span class="n">refresh_data</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">refresh_data</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;Using cached version of the data set, to use latest version set refresh_data to True&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;co2_mm_mlo.txt&#39;</span><span class="p">))</span>
    <span class="k">print</span> <span class="s">&#39;Most recent data observation from month &#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">&#39; in year &#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">allX</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mf">99.99</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">allY</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mf">99.99</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">allX</span><span class="p">[:</span><span class="n">num_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">allX</span><span class="p">[</span><span class="n">num_train</span><span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">allY</span><span class="p">[:</span><span class="n">num_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">allY</span><span class="p">[</span><span class="n">num_train</span><span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Mauna Loa data with &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_train</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; values used as training points.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="boxjenkins_airline"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.boxjenkins_airline">[docs]</a><span class="k">def</span> <span class="nf">boxjenkins_airline</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;boxjenkins_airline&#39;</span><span class="p">,</span> <span class="n">num_train</span><span class="o">=</span><span class="mi">96</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;boxjenkins_airline.csv&#39;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="n">num_train</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="n">num_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">num_train</span><span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">num_train</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Montly airline passenger data from Box &amp; Jenkins 1976.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="osu_run1"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.osu_run1">[docs]</a><span class="k">def</span> <span class="nf">osu_run1</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;osu_run1&#39;</span><span class="p">,</span> <span class="n">sample_every</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="nb">zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;run1TXT.ZIP&#39;</span><span class="p">),</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
            <span class="nb">zip</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">Y</span><span class="p">,</span> <span class="n">connect</span> <span class="o">=</span> <span class="n">GPy</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">mocap</span><span class="o">.</span><span class="n">load_text_data</span><span class="p">(</span><span class="s">&#39;Aug210106&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">sample_every</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;connect&#39;</span> <span class="p">:</span> <span class="n">connect</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="swiss_roll_generated"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.swiss_roll_generated">[docs]</a><span class="k">def</span> <span class="nf">swiss_roll_generated</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s">&#39;datasets&#39;</span><span class="p">,</span> <span class="s">&#39;swiss_roll.pickle&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">Na</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="n">Na</span><span class="p">])[:</span><span class="n">num_samples</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;colors&#39;</span><span class="p">][</span><span class="n">perm</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">so</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">so</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">so</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">so</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="n">Y</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">:</span><span class="n">t</span><span class="p">,</span> <span class="s">&#39;colors&#39;</span><span class="p">:</span><span class="n">c</span><span class="p">}</span>
</div>
<div class="viewcode-block" id="hapmap3"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.hapmap3">[docs]</a><span class="k">def</span> <span class="nf">hapmap3</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;hapmap3&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The HapMap phase three SNP dataset - 1184 samples out of 11 populations.</span>

<span class="sd">    SNP_matrix (A) encoding [see Paschou et all. 2007 (PCA-Correlated SNPs...)]:</span>
<span class="sd">    Let (B1,B2) be the alphabetically sorted bases, which occur in the j-th SNP, then</span>

<span class="sd">          /  1, iff SNPij==(B1,B1)</span>
<span class="sd">    Aij = |  0, iff SNPij==(B1,B2)</span>
<span class="sd">          \ -1, iff SNPij==(B2,B2)</span>

<span class="sd">    The SNP data and the meta information (such as iid, sex and phenotype) are</span>
<span class="sd">    stored in the dataframe datadf, index is the Individual ID,</span>
<span class="sd">    with following columns for metainfo:</span>

<span class="sd">        * family_id   -&gt; Family ID</span>
<span class="sd">        * paternal_id -&gt; Paternal ID</span>
<span class="sd">        * maternal_id -&gt; Maternal ID</span>
<span class="sd">        * sex         -&gt; Sex (1=male; 2=female; other=unknown)</span>
<span class="sd">        * phenotype   -&gt; Phenotype (-9, or 0 for unknown)</span>
<span class="sd">        * population  -&gt; Population string (e.g. &#39;ASW&#39; - &#39;YRI&#39;)</span>
<span class="sd">        * rest are SNP rs (ids)</span>

<span class="sd">    More information is given in infodf:</span>

<span class="sd">        * Chromosome:</span>
<span class="sd">            - autosomal chromosemes                -&gt; 1-22</span>
<span class="sd">            - X    X chromosome                    -&gt; 23</span>
<span class="sd">            - Y    Y chromosome                    -&gt; 24</span>
<span class="sd">            - XY   Pseudo-autosomal region of X    -&gt; 25</span>
<span class="sd">            - MT   Mitochondrial                   -&gt; 26</span>
<span class="sd">        * Relative Positon (to Chromosome) [base pairs]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_pickle</span><span class="p">,</span> <span class="n">DataFrame</span>
        <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">stdout</span>
        <span class="kn">import</span> <span class="nn">bz2</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">i</span><span class="p">,</span> <span class="s">&quot;Need pandas for hapmap dataset, make sure to install pandas (http://pandas.pydata.org/) before loading the hapmap dataset&quot;</span>

    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="s">&#39;hapmap3&#39;</span><span class="p">)</span>
    <span class="n">hapmap_file_name</span> <span class="o">=</span> <span class="s">&#39;hapmap3_r2_b36_fwd.consensus.qc.poly&#39;</span>
    <span class="n">unpacked_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">hapmap_file_name</span><span class="o">+</span><span class="n">ending</span><span class="p">)</span> <span class="k">for</span> <span class="n">ending</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;.ped&#39;</span><span class="p">,</span> <span class="s">&#39;.map&#39;</span><span class="p">]]</span>
    <span class="n">unpacked_files_exist</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">,</span> <span class="n">unpacked_files</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">unpacked_files_exist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>

    <span class="n">preprocessed_data_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="n">hapmap_file_name</span> <span class="o">+</span> <span class="n">file_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> \
                               <span class="p">[</span><span class="s">&#39;.snps.pickle&#39;</span><span class="p">,</span>
                                <span class="s">&#39;.info.pickle&#39;</span><span class="p">,</span>
                                <span class="s">&#39;.nan.pickle&#39;</span><span class="p">]]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">,</span> <span class="n">preprocessed_data_paths</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">overide_manual_authorize</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">prompt_user</span><span class="p">(</span><span class="s">&quot;Preprocessing requires ~25GB &quot;</span>
                            <span class="s">&quot;of memory and can take a (very) long time, continue? [Y/n]&quot;</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">&quot;Preprocessing required for further usage.&quot;</span>
            <span class="k">return</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s">&quot;Preprocessing data, please be patient...&quot;</span>
        <span class="k">print</span> <span class="n">status</span>
        <span class="k">def</span> <span class="nf">write_status</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">progress</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">));</span> <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\r</span><span class="s">&quot;</span><span class="p">);</span> <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">status</span> <span class="o">=</span> <span class="s">r&quot;[{perc: &lt;{ll}}] {message: &lt;13s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">ll</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                                               <span class="n">perc</span><span class="o">=</span><span class="s">&quot;=&quot;</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="mf">20.</span><span class="o">*</span><span class="n">progress</span><span class="o">/</span><span class="mf">100.</span><span class="p">))</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">status</span><span class="p">);</span> <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">status</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unpacked_files_exist</span><span class="p">:</span>
            <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;unpacking...&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">curr</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">newfilepath</span> <span class="ow">in</span> <span class="n">unpacked_files</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">newfilepath</span><span class="p">):</span>
                    <span class="n">filepath</span> <span class="o">=</span> <span class="n">newfilepath</span> <span class="o">+</span> <span class="s">&#39;.bz2&#39;</span>
                    <span class="n">file_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">newfilepath</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">new_file</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">decomp</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">BZ2Decompressor</span><span class="p">()</span>
                        <span class="n">file_processed</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">buffsize</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">1024</span>
                        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">buffsize</span><span class="p">),</span> <span class="n">b</span><span class="s">&#39;&#39;</span><span class="p">):</span>
                            <span class="n">new_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">decomp</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
                            <span class="n">file_processed</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                            <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;unpacking...&#39;</span><span class="p">,</span> <span class="n">curr</span><span class="o">+</span><span class="mf">12.</span><span class="o">*</span><span class="n">file_processed</span><span class="o">/</span><span class="p">(</span><span class="n">file_size</span><span class="p">),</span> <span class="n">status</span><span class="p">)</span>
                <span class="n">curr</span> <span class="o">+=</span> <span class="mi">12</span>
                <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;unpacking...&#39;</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;reading .ped...&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="c"># Preprocess data:</span>
        <span class="n">snpstrnp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">unpacked_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;reading .map...&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">mapnp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">unpacked_files</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;reading relationships.txt...&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="c"># and metainfo:</span>
        <span class="n">infodf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span><span class="s">&#39;./relationships_w_pops_121708.txt&#39;</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">infodf</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">&#39;IID&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;filtering nan...&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">snpstr</span> <span class="o">=</span> <span class="n">snpstrnp</span><span class="p">[:,</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;S1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">snpstrnp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">inan</span> <span class="o">=</span> <span class="n">snpstr</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;0&#39;</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;filtering reference alleles...&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">snpstr</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)[:,:,:]))</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;encoding snps...&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="c"># Encode the information for each gene in {-1,0,1}:</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;encoding snps...&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">snps</span> <span class="o">=</span> <span class="p">(</span><span class="n">snpstr</span><span class="o">==</span><span class="n">ref</span><span class="p">[</span><span class="bp">None</span><span class="p">,:,:])</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;encoding snps...&#39;</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">snps</span> <span class="o">=</span> <span class="p">(</span><span class="n">snps</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,:])</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;encoding snps...&#39;</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">snps</span> <span class="o">=</span> <span class="n">snps</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;encoding snps...&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">snps</span> <span class="o">=</span> <span class="n">snps</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;i8&#39;</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;marking nan values...&#39;</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="c"># put in nan values (masked as -128):</span>
        <span class="n">snps</span><span class="p">[</span><span class="n">inan</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">128</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;setting up meta...&#39;</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="c"># get meta information:</span>
        <span class="n">metaheader</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[[</span><span class="s">&#39;family_id&#39;</span><span class="p">,</span> <span class="s">&#39;iid&#39;</span><span class="p">,</span> <span class="s">&#39;paternal_id&#39;</span><span class="p">,</span> <span class="s">&#39;maternal_id&#39;</span><span class="p">,</span> <span class="s">&#39;sex&#39;</span><span class="p">,</span> <span class="s">&#39;phenotype&#39;</span><span class="p">]]</span>
        <span class="n">metadf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">metaheader</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">snpstrnp</span><span class="p">[:,:</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">metadf</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">&#39;iid&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metadf</span> <span class="o">=</span> <span class="n">metadf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">infodf</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
        <span class="n">metadf</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">preprocessed_data_paths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c"># put everything together:</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;setting up snps...&#39;</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">snpsdf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">metadf</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">snps</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">mapnp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">preprocessed_data_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">snpsdf</span><span class="p">,</span> <span class="n">protocoll</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;setting up snps...&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="n">inandf</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">metadf</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">inan</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">mapnp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">inandf</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">preprocessed_data_paths</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">status</span><span class="o">=</span><span class="n">write_status</span><span class="p">(</span><span class="s">&#39;done :)&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;loading snps...&quot;</span>
        <span class="n">snpsdf</span> <span class="o">=</span> <span class="n">read_pickle</span><span class="p">(</span><span class="n">preprocessed_data_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span> <span class="s">&quot;loading metainfo...&quot;</span>
        <span class="n">metadf</span> <span class="o">=</span> <span class="n">read_pickle</span><span class="p">(</span><span class="n">preprocessed_data_paths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">print</span> <span class="s">&quot;loading nan entries...&quot;</span>
        <span class="n">inandf</span> <span class="o">=</span> <span class="n">read_pickle</span><span class="p">(</span><span class="n">preprocessed_data_paths</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">snps</span> <span class="o">=</span> <span class="n">snpsdf</span><span class="o">.</span><span class="n">values</span>
    <span class="n">populations</span> <span class="o">=</span> <span class="n">metadf</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;S3&#39;</span><span class="p">)</span>
    <span class="n">hapmap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">data_set</span><span class="p">,</span>
                  <span class="n">description</span><span class="o">=</span><span class="s">&#39;The HapMap phase three SNP dataset - &#39;</span>
                  <span class="s">&#39;1184 samples out of 11 populations. inan is a &#39;</span>
                  <span class="s">&#39;boolean array, containing wheather or not the &#39;</span>
                  <span class="s">&#39;given entry is nan (nans are masked as &#39;</span>
                  <span class="s">&#39;-128 in snps).&#39;</span><span class="p">,</span>
                  <span class="n">snpsdf</span><span class="o">=</span><span class="n">snpsdf</span><span class="p">,</span>
                  <span class="n">metadf</span><span class="o">=</span><span class="n">metadf</span><span class="p">,</span>
                  <span class="n">snps</span><span class="o">=</span><span class="n">snps</span><span class="p">,</span>
                  <span class="n">inan</span><span class="o">=</span><span class="n">inandf</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                  <span class="n">inandf</span><span class="o">=</span><span class="n">inandf</span><span class="p">,</span>
                  <span class="n">populations</span><span class="o">=</span><span class="n">populations</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hapmap</span>
</div>
<div class="viewcode-block" id="singlecell"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.singlecell">[docs]</a><span class="k">def</span> <span class="nf">singlecell</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;singlecell&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;singlecell.csv&#39;</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">genes</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">index</span>
    <span class="c"># data = np.loadtxt(os.path.join(dir_path, &#39;singlecell.csv&#39;), delimiter=&quot;,&quot;, dtype=str)</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span> <span class="p">:</span> <span class="s">&quot;qPCR singlecell experiment in Mouse, measuring 48 gene expressions in 1-64 cell states. The labels have been created as in Guo et al. [2010]&quot;</span><span class="p">,</span>
                                <span class="s">&#39;genes&#39;</span><span class="p">:</span> <span class="n">genes</span><span class="p">,</span> <span class="s">&#39;labels&#39;</span><span class="p">:</span><span class="n">labels</span><span class="p">,</span>
                                <span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="singlecell_rna_seq_islam"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.singlecell_rna_seq_islam">[docs]</a><span class="k">def</span> <span class="nf">singlecell_rna_seq_islam</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s">&#39;singlecell_islam&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">concat</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;GSE29087_L139_expression_tab.txt.gz&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">header1</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">)</span>
    <span class="n">header2</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">header1</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">header2</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">:]))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">&quot;Feature&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">8</span><span class="p">:,</span> <span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="c"># read the info .soft</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;GSE29087_family.soft.gz&#39;</span><span class="p">)</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="c"># split at &#39; = &#39;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; = &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="c"># only take samples:</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&quot;!Sample&quot;</span><span class="p">)]</span>
    <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s">&quot;!Sample_&quot;</span><span class="p">):])</span>

    <span class="n">groups</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
    <span class="c"># remove &#39;GGG&#39; from barcodes</span>
    <span class="n">barcode</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">groups</span><span class="p">[</span><span class="s">&#39;barcode&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">groups</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]]</span>
    <span class="n">title</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">barcode</span>
    <span class="n">title</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;title&#39;</span>
    <span class="n">geo_accession</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">groups</span><span class="p">[</span><span class="s">&#39;geo_accession&#39;</span><span class="p">]]</span>
    <span class="n">geo_accession</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">barcode</span>
    <span class="n">geo_accession</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;geo_accession&#39;</span>
    <span class="n">case_id</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">groups</span><span class="p">[</span><span class="s">&#39;source_name_ch1&#39;</span><span class="p">]]</span>
    <span class="n">case_id</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">barcode</span>
    <span class="n">case_id</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;source_name_ch1&#39;</span>

    <span class="n">info</span> <span class="o">=</span> <span class="n">concat</span><span class="p">([</span><span class="n">title</span><span class="p">,</span> <span class="n">geo_accession</span><span class="p">,</span> <span class="n">case_id</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">.</span><span class="n">source_name_ch1</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">labels</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="s">&#39;Embryonic stem cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;ES&quot;</span>
    <span class="n">labels</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="s">&#39;Embryonic fibroblast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;MEF&quot;</span>

    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span>
                                <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&#39;92 single cells (48 mouse ES cells, 44 mouse embryonic fibroblasts and 4 negative controls) were analyzed by single-cell tagged reverse transcription (STRT)&#39;</span><span class="p">,</span>
                                <span class="s">&#39;genes&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                                <span class="s">&#39;labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                                <span class="s">&#39;datadf&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                                <span class="s">&#39;infodf&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">},</span> <span class="n">dataset</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="singlecell_rna_seq_deng"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.singlecell_rna_seq_deng">[docs]</a><span class="k">def</span> <span class="nf">singlecell_rna_seq_deng</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s">&#39;singlecell_deng&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span><span class="p">,</span> <span class="n">isnull</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>

    <span class="c"># read the info .soft</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;GSE45719_series_matrix.txt.gz&#39;</span><span class="p">)</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">29</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">&#39;!Series_summary&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">design</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">&#39;!Series_overall_design&#39;</span><span class="p">]</span>

    <span class="c"># only take samples:</span>
    <span class="n">sample_info</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">sample_info</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s">&quot;!Sample_&quot;</span><span class="p">):])</span>
    <span class="n">sample_info</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s">&quot;!Sample_&quot;</span><span class="p">):]</span>
    <span class="n">sample_info</span> <span class="o">=</span> <span class="n">sample_info</span><span class="p">[[</span><span class="s">&#39;geo_accession&#39;</span><span class="p">,</span> <span class="s">&#39;characteristics_ch1&#39;</span><span class="p">,</span>  <span class="s">&#39;description&#39;</span><span class="p">]]</span>
    <span class="n">sample_info</span> <span class="o">=</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="n">sample_info</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>
    <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;strain&#39;</span><span class="p">,</span> <span class="s">&#39;cross&#39;</span><span class="p">,</span> <span class="s">&#39;developmental_stage&#39;</span><span class="p">]</span>
    <span class="n">sample_info</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">c</span>

    <span class="c"># get the labels right:</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;\(.*\)&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">filter_dev_stage</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">isnull</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="s">&quot;2-cell stage embryo&quot;</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;developmental stage: &quot;</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s">&quot;developmental stage: &quot;</span><span class="p">):]</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="s">&#39;adult&#39;</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="s">&quot; liver&quot;</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; stage &#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">row</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">developmental_stage</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filter_dev_stage</span><span class="p">)</span>

    <span class="c"># Extract the tar file</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;GSE45719_Raw.tar&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Extracting Archive {}...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">gene_info</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">getmembers</span><span class="p">()</span>
        <span class="n">overall</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">members</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">file_info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">members</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="n">file_info</span><span class="p">)</span>
            <span class="n">inner</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">,</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;{: &gt;7.2%}: Extracting: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">overall</span><span class="p">,</span> <span class="n">file_info</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span><span class="o">+</span><span class="s">&quot;...txt.gz&quot;</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">message</span><span class="p">,</span>
            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">inner</span><span class="o">.</span><span class="n">RPKM</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
                <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_info</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">18</span><span class="p">]]</span>
                <span class="n">gene_info</span> <span class="o">=</span> <span class="n">inner</span><span class="o">.</span><span class="n">Refseq_IDs</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
                <span class="n">gene_info</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_info</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">18</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">file_info</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">18</span><span class="p">]]</span> <span class="o">=</span> <span class="n">inner</span><span class="o">.</span><span class="n">RPKM</span>
                <span class="n">gene_info</span><span class="p">[</span><span class="n">file_info</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">18</span><span class="p">]]</span> <span class="o">=</span> <span class="n">inner</span><span class="o">.</span><span class="n">Refseq_IDs</span>

    <span class="c"># Strip GSM number off data index</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;GSM\d+_&#39;</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="n">rep</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">end</span><span class="p">():])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>

    <span class="c"># make sure the same index gets used</span>
    <span class="n">sample_info</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>

    <span class="c"># get the labels from the description</span>
    <span class="c">#rep = re.compile(&#39;fibroblast|\d+-cell|embryo|liver|early blastocyst|mid blastocyst|late blastocyst|blastomere|zygote&#39;, re.IGNORECASE)</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">print</span>
    <span class="k">print</span> <span class="s">&quot;Read Archive {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                                <span class="s">&#39;series_info&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span>
                                <span class="s">&#39;sample_info&#39;</span><span class="p">:</span> <span class="n">sample_info</span><span class="p">,</span>
                                <span class="s">&#39;gene_info&#39;</span><span class="p">:</span> <span class="n">gene_info</span><span class="p">,</span>
                                <span class="s">&#39;summary&#39;</span><span class="p">:</span> <span class="n">summary</span><span class="p">,</span>
                                <span class="s">&#39;design&#39;</span><span class="p">:</span> <span class="n">design</span><span class="p">,</span>
                                <span class="s">&#39;genes&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                                <span class="s">&#39;labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                                <span class="p">},</span> <span class="n">dataset</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="swiss_roll_1000"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.swiss_roll_1000">[docs]</a><span class="k">def</span> <span class="nf">swiss_roll_1000</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">swiss_roll</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="swiss_roll"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.swiss_roll">[docs]</a><span class="k">def</span> <span class="nf">swiss_roll</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="s">&#39;swiss_roll&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">mat_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;swiss_roll_data.mat&#39;</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;X_data&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">num_samples</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;X_data&#39;</span><span class="p">],</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;The first &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; points from the swiss roll data of Tennenbaum, de Silva and Langford (2001).&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="isomap_faces"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.isomap_faces">[docs]</a><span class="k">def</span> <span class="nf">isomap_faces</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="mi">698</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="s">&#39;isomap_face_data&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">mat_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;face_data.mat&#39;</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;images&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">num_samples</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;poses&#39;</span> <span class="p">:</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;poses&#39;</span><span class="p">],</span> <span class="s">&#39;lights&#39;</span><span class="p">:</span> <span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;lights&#39;</span><span class="p">],</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;The first &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; points from the face data of Tennenbaum, de Silva and Langford (2001).&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="simulation_BGPLVM"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.simulation_BGPLVM">[docs]</a><span class="k">def</span> <span class="nf">simulation_BGPLVM</span><span class="p">():</span>
    <span class="n">mat_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s">&#39;BGPLVMSimulation.mat&#39;</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;initS&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat_data</span><span class="p">[</span><span class="s">&#39;initMu&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="c">#return data_details_return({&#39;S&#39;: S, &#39;Y&#39;: Y, &#39;mu&#39;: mu}, data_set)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span>
            <span class="s">&#39;mu&#39;</span> <span class="p">:</span> <span class="n">mu</span><span class="p">,</span>
            <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Simulated test dataset generated in MATLAB to compare BGPLVM between python and MATLAB&quot;</span><span class="p">}</span>
</div>
<div class="viewcode-block" id="toy_rbf_1d"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.toy_rbf_1d">[docs]</a><span class="k">def</span> <span class="nf">toy_rbf_1d</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Samples values of a function from an RBF covariance with very small noise for inputs uniformly distributed between -1 and 1.</span>

<span class="sd">    :param seed: seed to use for random sampling.</span>
<span class="sd">    :type seed: int</span>
<span class="sd">    :param num_samples: number of samples to sample in the function (default 500).</span>
<span class="sd">    :type num_samples: int</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">num_in</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_in</span><span class="p">))</span>
    <span class="n">X</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">rbf</span> <span class="o">=</span> <span class="n">GPy</span><span class="o">.</span><span class="n">kern</span><span class="o">.</span><span class="n">RBF</span><span class="p">(</span><span class="n">num_in</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthscale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">0.25</span><span class="p">,)))</span>
    <span class="n">white</span> <span class="o">=</span> <span class="n">GPy</span><span class="o">.</span><span class="n">kern</span><span class="o">.</span><span class="n">White</span><span class="p">(</span><span class="n">num_in</span><span class="p">,</span> <span class="n">variance</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">rbf</span> <span class="o">+</span> <span class="n">white</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_samples</span><span class="p">),</span> <span class="n">K</span><span class="p">),</span> <span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Sampled &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; values of a function from an RBF covariance with very small noise for inputs uniformly distributed between -1 and 1.&quot;</span><span class="p">}</span>
</div>
<div class="viewcode-block" id="toy_rbf_1d_50"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.toy_rbf_1d_50">[docs]</a><span class="k">def</span> <span class="nf">toy_rbf_1d_50</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">toy_rbf_1d</span><span class="p">()</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>
    <span class="n">indices</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">][</span><span class="n">indices</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">][</span><span class="n">indices</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Subsamples the toy_rbf_sample with 50 values randomly taken from the original sample.&quot;</span><span class="p">,</span> <span class="s">&#39;seed&#39;</span> <span class="p">:</span> <span class="n">seed</span><span class="p">}</span>

</div>
<div class="viewcode-block" id="toy_linear_1d_classification"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.toy_linear_1d_classification">[docs]</a><span class="k">def</span> <span class="nf">toy_linear_1d_classification</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span>  <span class="n">sample_class</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">X</span><span class="p">),</span> <span class="s">&#39;F&#39;</span><span class="p">:</span> <span class="mf">2.</span><span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="s">&#39;seed&#39;</span> <span class="p">:</span> <span class="n">seed</span><span class="p">}</span>
</div>
<div class="viewcode-block" id="olivetti_glasses"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olivetti_glasses">[docs]</a><span class="k">def</span> <span class="nf">olivetti_glasses</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;olivetti_glasses&#39;</span><span class="p">,</span> <span class="n">num_training</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;has_glasses.np&#39;</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">faces</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;olivettifaces.mat&#39;</span><span class="p">))[</span><span class="s">&#39;faces&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">faces</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[</span><span class="n">index</span><span class="p">[:</span><span class="n">num_training</span><span class="p">],:]</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">faces</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">num_training</span><span class="p">:],:]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[:</span><span class="n">num_training</span><span class="p">],:]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">num_training</span><span class="p">:]]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;Xtest&#39;</span><span class="p">:</span> <span class="n">Xtest</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;seed&#39;</span> <span class="p">:</span> <span class="n">seed</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;ORL Faces with labels identifiying who is wearing glasses and who isn&#39;t. Data is randomly partitioned according to given seed. Presence or absence of glasses was labelled by James Hensman.&quot;</span><span class="p">},</span> <span class="s">&#39;olivetti_faces&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olivetti_faces"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olivetti_faces">[docs]</a><span class="k">def</span> <span class="nf">olivetti_faces</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;olivetti_faces&#39;</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="nb">zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;att_faces.zip&#39;</span><span class="p">),</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
            <span class="nb">zip</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lbls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;orl_faces&#39;</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subject</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">image</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.pgm&#39;</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">GPy.util</span> <span class="kn">import</span> <span class="n">netpbmfile</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">netpbmfile</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
            <span class="n">lbls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lbls</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;lbls&#39;</span> <span class="p">:</span> <span class="n">lbls</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;ORL Faces processed to 64x64 images.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="xw_pen"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.xw_pen">[docs]</a><span class="k">def</span> <span class="nf">xw_pen</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;xw_pen&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;xw_pen_15.csv&#39;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">485</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Tilt data from a personalized digital assistant pen. Plot in original paper showed regression between time steps 175 and 275.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="download_rogers_girolami_data"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.download_rogers_girolami_data">[docs]</a><span class="k">def</span> <span class="nf">download_rogers_girolami_data</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
        <span class="n">tar_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;firstcoursemldata.tar.gz&#39;</span><span class="p">)</span>
        <span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tar_file</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Extracting file.&#39;</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="olympic_100m_men"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_100m_men">[docs]</a><span class="k">def</span> <span class="nf">olympic_100m_men</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="n">download_rogers_girolami_data</span><span class="p">()</span>
    <span class="n">olympic_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;olympics.mat&#39;</span><span class="p">))[</span><span class="s">&#39;male100&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Olympic sprint times for 100 m men from 1896 until 2008. Example is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_100m_women"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_100m_women">[docs]</a><span class="k">def</span> <span class="nf">olympic_100m_women</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="n">download_rogers_girolami_data</span><span class="p">()</span>
    <span class="n">olympic_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;olympics.mat&#39;</span><span class="p">))[</span><span class="s">&#39;female100&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Olympic sprint times for 100 m women from 1896 until 2008. Example is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_200m_women"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_200m_women">[docs]</a><span class="k">def</span> <span class="nf">olympic_200m_women</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="n">download_rogers_girolami_data</span><span class="p">()</span>
    <span class="n">olympic_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;olympics.mat&#39;</span><span class="p">))[</span><span class="s">&#39;female200&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Olympic 200 m winning times for women from 1896 until 2008. Data is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_200m_men"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_200m_men">[docs]</a><span class="k">def</span> <span class="nf">olympic_200m_men</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="n">download_rogers_girolami_data</span><span class="p">()</span>
    <span class="n">olympic_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;olympics.mat&#39;</span><span class="p">))[</span><span class="s">&#39;male200&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Male 200 m winning times for women from 1896 until 2008. Data is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_400m_women"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_400m_women">[docs]</a><span class="k">def</span> <span class="nf">olympic_400m_women</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="n">download_rogers_girolami_data</span><span class="p">()</span>
    <span class="n">olympic_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;olympics.mat&#39;</span><span class="p">))[</span><span class="s">&#39;female400&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Olympic 400 m winning times for women until 2008. Data is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_400m_men"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_400m_men">[docs]</a><span class="k">def</span> <span class="nf">olympic_400m_men</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="n">download_rogers_girolami_data</span><span class="p">()</span>
    <span class="n">olympic_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="s">&#39;olympics.mat&#39;</span><span class="p">))[</span><span class="s">&#39;male400&#39;</span><span class="p">]</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympic_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Male 400 m winning times for women until 2008. Data is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_marathon_men"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_marathon_men">[docs]</a><span class="k">def</span> <span class="nf">olympic_marathon_men</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;olympic_marathon_men&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">olympics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;olympicMarathonTimes.csv&#39;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">olympics</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">olympics</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="olympic_sprints"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.olympic_sprints">[docs]</a><span class="k">def</span> <span class="nf">olympic_sprints</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;rogers_girolami_data&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;All olympics sprint winning times for multiple output prediction.&quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">olympic_100m_men</span><span class="p">,</span>
                              <span class="n">olympic_100m_women</span><span class="p">,</span>
                              <span class="n">olympic_200m_men</span><span class="p">,</span>
                              <span class="n">olympic_200m_women</span><span class="p">,</span>
                              <span class="n">olympic_400m_men</span><span class="p">,</span>
                              <span class="n">olympic_400m_women</span><span class="p">]):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">()</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">year</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))))</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">Y</span><span class="p">,</span> <span class="n">time</span><span class="p">))</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Olympics sprint event winning for men and women to 2008. Data is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span>
        <span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span>
        <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span>
        <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Olympics sprint event winning for men and women to 2008. Data is from Rogers and Girolami&#39;s First Course in Machine Learning.&quot;</span><span class="p">,</span>
        <span class="s">&#39;output_info&#39;</span><span class="p">:</span> <span class="p">{</span>
          <span class="mi">0</span><span class="p">:</span><span class="s">&#39;100m Men&#39;</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">:</span><span class="s">&#39;100m Women&#39;</span><span class="p">,</span>
          <span class="mi">2</span><span class="p">:</span><span class="s">&#39;200m Men&#39;</span><span class="p">,</span>
          <span class="mi">3</span><span class="p">:</span><span class="s">&#39;200m Women&#39;</span><span class="p">,</span>
          <span class="mi">4</span><span class="p">:</span><span class="s">&#39;400m Men&#39;</span><span class="p">,</span>
          <span class="mi">5</span><span class="p">:</span><span class="s">&#39;400m Women&#39;</span><span class="p">}</span>
        <span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>

<span class="c"># def movielens_small(partNo=1,seed=default_seed):</span>
<span class="c">#     np.random.seed(seed=seed)</span>

<span class="c">#     fileName = os.path.join(data_path, &#39;movielens&#39;, &#39;small&#39;, &#39;u&#39; + str(partNo) + &#39;.base&#39;)</span>
<span class="c">#     fid = open(fileName)</span>
<span class="c">#     uTrain = np.fromfile(fid, sep=&#39;\t&#39;, dtype=np.int16).reshape((-1, 4))</span>
<span class="c">#     fid.close()</span>
<span class="c">#     maxVals = np.amax(uTrain, axis=0)</span>
<span class="c">#     numUsers = maxVals[0]</span>
<span class="c">#     numFilms = maxVals[1]</span>
<span class="c">#     numRatings = uTrain.shape[0]</span>

<span class="c">#     Y = scipy.sparse.lil_matrix((numFilms, numUsers), dtype=np.int8)</span>
<span class="c">#     for i in range(numUsers):</span>
<span class="c">#         ind = pb.mlab.find(uTrain[:, 0]==i+1)</span>
<span class="c">#         Y[uTrain[ind, 1]-1, i] = uTrain[ind, 2]</span>

<span class="c">#     fileName = os.path.join(data_path, &#39;movielens&#39;, &#39;small&#39;, &#39;u&#39; + str(partNo) + &#39;.test&#39;)</span>
<span class="c">#     fid = open(fileName)</span>
<span class="c">#     uTest = np.fromfile(fid, sep=&#39;\t&#39;, dtype=np.int16).reshape((-1, 4))</span>
<span class="c">#     fid.close()</span>
<span class="c">#     numTestRatings = uTest.shape[0]</span>

<span class="c">#     Ytest = scipy.sparse.lil_matrix((numFilms, numUsers), dtype=np.int8)</span>
<span class="c">#     for i in range(numUsers):</span>
<span class="c">#         ind = pb.mlab.find(uTest[:, 0]==i+1)</span>
<span class="c">#         Ytest[uTest[ind, 1]-1, i] = uTest[ind, 2]</span>

<span class="c">#     lbls = np.empty((1,1))</span>
<span class="c">#     lblstest = np.empty((1,1))</span>
<span class="c">#     return {&#39;Y&#39;:Y, &#39;lbls&#39;:lbls, &#39;Ytest&#39;:Ytest, &#39;lblstest&#39;:lblstest}</span>

</div>
<div class="viewcode-block" id="crescent_data"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.crescent_data">[docs]</a><span class="k">def</span> <span class="nf">crescent_data</span><span class="p">(</span><span class="n">num_data</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">default_seed</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Data set formed from a mixture of four Gaussians. In each class two of the Gaussians are elongated at right angles to each other and offset to form an approximation to the crescent data that is popular in semi-supervised learning as a toy problem.</span>

<span class="sd">    :param num_data_part: number of data to be sampled (default is 200).</span>
<span class="sd">    :type num_data: int</span>
<span class="sd">    :param seed: random seed to be used for data generation.</span>
<span class="sd">    :type seed: int</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">sqrt2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="c"># Rotation matrix</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">sqrt2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">sqrt2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sqrt2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]])</span>
    <span class="c"># Scaling matrices</span>
    <span class="n">scales</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">scales</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]))</span>
    <span class="n">scales</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]))</span>
    <span class="n">scales</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
    <span class="n">scales</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
    <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
    <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
    <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]))</span>
    <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]))</span>

    <span class="n">Xparts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">num_data_part</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">num_data_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">num_data_part</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_data</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">))</span>
        <span class="n">num_data_part</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">num_data_total</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_data_part</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">Xparts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="n">num_data_total</span> <span class="o">+=</span> <span class="n">num_data_part</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">Xparts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Xparts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Xparts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Xparts</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">num_data_part</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">num_data_part</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">num_data_part</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">num_data_part</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">))))</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;X&#39;</span><span class="p">:</span><span class="n">X</span><span class="p">,</span> <span class="s">&#39;Y&#39;</span><span class="p">:</span><span class="n">Y</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="s">&quot;Two separate classes of data formed approximately in the shape of two crescents.&quot;</span><span class="p">}</span>
</div>
<div class="viewcode-block" id="creep_data"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.creep_data">[docs]</a><span class="k">def</span> <span class="nf">creep_data</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;creep_rupture&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Brun and Yoshida&#39;s metal creep rupture data.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
        <span class="n">tar_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;creeprupt.tar&#39;</span><span class="p">)</span>
        <span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tar_file</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Extracting file.&#39;</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">all_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">,</span> <span class="s">&#39;taka&#39;</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">features</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[:,</span> <span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="cifar10_patches"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.cifar10_patches">[docs]</a><span class="k">def</span> <span class="nf">cifar10_patches</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;cifar-10&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Candian Institute for Advanced Research 10 image data set. Code for loading in this data is taken from this Boris Babenko&#39;s blog post, original code available here: http://bbabenko.tumblr.com/post/86756017649/learning-low-level-vision-feautres-in-10-lines-of-code&quot;&quot;&quot;</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;cifar-10-python.tar.gz&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_available</span><span class="p">(</span><span class="n">data_set</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">tarfile</span>
        <span class="c"># This code is from Boris Babenko&#39;s blog post.</span>
        <span class="c"># http://bbabenko.tumblr.com/post/86756017649/learning-low-level-vision-feautres-in-10-lines-of-code</span>
        <span class="n">tfile</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r:gz&#39;</span><span class="p">)</span>
        <span class="n">tfile</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s">&#39;cifar-10-batches-py&#39;</span><span class="p">,</span><span class="s">&#39;data_batch_1&#39;</span><span class="p">),</span><span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">images</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;float32&#39;</span><span class="p">)</span><span class="o">/</span><span class="mi">255</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">32</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">32</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">patches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">patches</span><span class="p">,</span> <span class="n">images</span><span class="p">[:,</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">+</span><span class="mi">5</span><span class="p">,:]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">patches</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">patches</span><span class="p">,</span> <span class="s">&quot;info&quot;</span> <span class="p">:</span> <span class="s">&quot;32x32 pixel patches extracted from the CIFAR-10 data by Boris Babenko to demonstrate k-means features.&quot;</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="cmu_mocap_49_balance"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.cmu_mocap_49_balance">[docs]</a><span class="k">def</span> <span class="nf">cmu_mocap_49_balance</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;cmu_mocap&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load CMU subject 49&#39;s one legged balancing motion that was used by Alvarez, Luengo and Lawrence at AISTATS 2009.&quot;&quot;&quot;</span>
    <span class="n">train_motions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;18&#39;</span><span class="p">,</span> <span class="s">&#39;19&#39;</span><span class="p">]</span>
    <span class="n">test_motions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;20&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">cmu_mocap</span><span class="p">(</span><span class="s">&#39;49&#39;</span><span class="p">,</span> <span class="n">train_motions</span><span class="p">,</span> <span class="n">test_motions</span><span class="p">,</span> <span class="n">sample_every</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;One legged balancing motions from CMU data base subject 49. As used in Alvarez, Luengo and Lawrence at AISTATS 2009. It consists of &quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span>
</div>
<div class="viewcode-block" id="cmu_mocap_35_walk_jog"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.cmu_mocap_35_walk_jog">[docs]</a><span class="k">def</span> <span class="nf">cmu_mocap_35_walk_jog</span><span class="p">(</span><span class="n">data_set</span><span class="o">=</span><span class="s">&#39;cmu_mocap&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load CMU subject 35&#39;s walking and jogging motions, the same data that was used by Taylor, Roweis and Hinton at NIPS 2007. but without their preprocessing. Also used by Lawrence at AISTATS 2007.&quot;&quot;&quot;</span>
    <span class="n">train_motions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;01&#39;</span><span class="p">,</span> <span class="s">&#39;02&#39;</span><span class="p">,</span> <span class="s">&#39;03&#39;</span><span class="p">,</span> <span class="s">&#39;04&#39;</span><span class="p">,</span> <span class="s">&#39;05&#39;</span><span class="p">,</span> <span class="s">&#39;06&#39;</span><span class="p">,</span>
                <span class="s">&#39;07&#39;</span><span class="p">,</span> <span class="s">&#39;08&#39;</span><span class="p">,</span> <span class="s">&#39;09&#39;</span><span class="p">,</span> <span class="s">&#39;10&#39;</span><span class="p">,</span> <span class="s">&#39;11&#39;</span><span class="p">,</span> <span class="s">&#39;12&#39;</span><span class="p">,</span>
                <span class="s">&#39;13&#39;</span><span class="p">,</span> <span class="s">&#39;14&#39;</span><span class="p">,</span> <span class="s">&#39;15&#39;</span><span class="p">,</span> <span class="s">&#39;16&#39;</span><span class="p">,</span> <span class="s">&#39;17&#39;</span><span class="p">,</span> <span class="s">&#39;19&#39;</span><span class="p">,</span>
                <span class="s">&#39;20&#39;</span><span class="p">,</span> <span class="s">&#39;21&#39;</span><span class="p">,</span> <span class="s">&#39;22&#39;</span><span class="p">,</span> <span class="s">&#39;23&#39;</span><span class="p">,</span> <span class="s">&#39;24&#39;</span><span class="p">,</span> <span class="s">&#39;25&#39;</span><span class="p">,</span>
                <span class="s">&#39;26&#39;</span><span class="p">,</span> <span class="s">&#39;28&#39;</span><span class="p">,</span> <span class="s">&#39;30&#39;</span><span class="p">,</span> <span class="s">&#39;31&#39;</span><span class="p">,</span> <span class="s">&#39;32&#39;</span><span class="p">,</span> <span class="s">&#39;33&#39;</span><span class="p">,</span> <span class="s">&#39;34&#39;</span><span class="p">]</span>
    <span class="n">test_motions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;18&#39;</span><span class="p">,</span> <span class="s">&#39;29&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">cmu_mocap</span><span class="p">(</span><span class="s">&#39;35&#39;</span><span class="p">,</span> <span class="n">train_motions</span><span class="p">,</span> <span class="n">test_motions</span><span class="p">,</span> <span class="n">sample_every</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="n">data_set</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Walk and jog data from CMU data base subject 35. As used in Tayor, Roweis and Hinton at NIPS 2007, but without their pre-processing (i.e. as used by Lawrence at AISTATS 2007). It consists of &quot;</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span>
</div>
<div class="viewcode-block" id="cmu_mocap"><a class="viewcode-back" href="../../../GPy.util.html#GPy.util.datasets.cmu_mocap">[docs]</a><span class="k">def</span> <span class="nf">cmu_mocap</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">train_motions</span><span class="p">,</span> <span class="n">test_motions</span><span class="o">=</span><span class="p">[],</span> <span class="n">sample_every</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">data_set</span><span class="o">=</span><span class="s">&#39;cmu_mocap&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load a given subject&#39;s training and test motions from the CMU motion capture data.&quot;&quot;&quot;</span>
    <span class="c"># Load in subject skeleton.</span>
    <span class="n">subject_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_set</span><span class="p">)</span>

    <span class="c"># Make sure the data is downloaded.</span>
    <span class="n">all_motions</span> <span class="o">=</span> <span class="n">train_motions</span> <span class="o">+</span> <span class="n">test_motions</span>
    <span class="n">resource</span> <span class="o">=</span> <span class="n">cmu_urls_files</span><span class="p">(([</span><span class="n">subject</span><span class="p">],</span> <span class="p">[</span><span class="n">all_motions</span><span class="p">]))</span>
    <span class="n">data_resources</span><span class="p">[</span><span class="n">data_set</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_resources</span><span class="p">[</span><span class="s">&#39;cmu_mocap_full&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_resources</span><span class="p">[</span><span class="n">data_set</span><span class="p">][</span><span class="s">&#39;files&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resource</span><span class="p">[</span><span class="s">&#39;files&#39;</span><span class="p">]</span>
    <span class="n">data_resources</span><span class="p">[</span><span class="n">data_set</span><span class="p">][</span><span class="s">&#39;urls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resource</span><span class="p">[</span><span class="s">&#39;urls&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">resource</span><span class="p">[</span><span class="s">&#39;urls&#39;</span><span class="p">]:</span>
        <span class="n">download_data</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>

    <span class="n">skel</span> <span class="o">=</span> <span class="n">GPy</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">mocap</span><span class="o">.</span><span class="n">acclaim_skeleton</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subject_dir</span><span class="p">,</span> <span class="n">subject</span> <span class="o">+</span> <span class="s">&#39;.asf&#39;</span><span class="p">))</span>

    <span class="c"># Set up labels for each sequence</span>
    <span class="n">exlbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_motions</span><span class="p">))</span>

    <span class="c"># Load sequences</span>
    <span class="n">tot_length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">temp_Y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">temp_lbls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_motions</span><span class="p">)):</span>
        <span class="n">temp_chan</span> <span class="o">=</span> <span class="n">skel</span><span class="o">.</span><span class="n">load_channels</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subject_dir</span><span class="p">,</span> <span class="n">subject</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">train_motions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.amc&#39;</span><span class="p">))</span>
        <span class="n">temp_Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_chan</span><span class="p">[::</span><span class="n">sample_every</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">temp_lbls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">exlbls</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">temp_Y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">tot_length</span> <span class="o">+=</span> <span class="n">temp_Y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_length</span><span class="p">,</span> <span class="n">temp_Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_length</span><span class="p">,</span> <span class="n">temp_lbls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">end_ind</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_Y</span><span class="p">)):</span>
        <span class="n">start_ind</span> <span class="o">=</span> <span class="n">end_ind</span>
        <span class="n">end_ind</span> <span class="o">+=</span> <span class="n">temp_Y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Y</span><span class="p">[</span><span class="n">start_ind</span><span class="p">:</span><span class="n">end_ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">temp_Y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">lbls</span><span class="p">[</span><span class="n">start_ind</span><span class="p">:</span><span class="n">end_ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">temp_lbls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_motions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">temp_Ytest</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">temp_lblstest</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">testexlbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_motions</span><span class="p">))</span>
        <span class="n">tot_test_length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_motions</span><span class="p">)):</span>
            <span class="n">temp_chan</span> <span class="o">=</span> <span class="n">skel</span><span class="o">.</span><span class="n">load_channels</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subject_dir</span><span class="p">,</span> <span class="n">subject</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">test_motions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.amc&#39;</span><span class="p">))</span>
            <span class="n">temp_Ytest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_chan</span><span class="p">[::</span><span class="n">sample_every</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">temp_lblstest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">testexlbls</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">temp_Ytest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">tot_test_length</span> <span class="o">+=</span> <span class="n">temp_Ytest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c"># Load test data</span>
        <span class="n">Ytest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_test_length</span><span class="p">,</span> <span class="n">temp_Ytest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">lblstest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_test_length</span><span class="p">,</span> <span class="n">temp_lblstest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">end_ind</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_Ytest</span><span class="p">)):</span>
            <span class="n">start_ind</span> <span class="o">=</span> <span class="n">end_ind</span>
            <span class="n">end_ind</span> <span class="o">+=</span> <span class="n">temp_Ytest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Ytest</span><span class="p">[</span><span class="n">start_ind</span><span class="p">:</span><span class="n">end_ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">temp_Ytest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">lblstest</span><span class="p">[</span><span class="n">start_ind</span><span class="p">:</span><span class="n">end_ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">temp_lblstest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ytest</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">lblstest</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">info</span> <span class="o">=</span> <span class="s">&#39;Subject: &#39;</span> <span class="o">+</span> <span class="n">subject</span> <span class="o">+</span> <span class="s">&#39;. Training motions: &#39;</span>
    <span class="k">for</span> <span class="n">motion</span> <span class="ow">in</span> <span class="n">train_motions</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">+=</span> <span class="n">motion</span> <span class="o">+</span> <span class="s">&#39;, &#39;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">info</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_motions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">+=</span> <span class="s">&#39;. Test motions: &#39;</span>
        <span class="k">for</span> <span class="n">motion</span> <span class="ow">in</span> <span class="n">test_motions</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">+=</span> <span class="n">motion</span> <span class="o">+</span> <span class="s">&#39;, &#39;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">info</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">+=</span> <span class="s">&#39;.&#39;</span>
    <span class="k">if</span> <span class="n">sample_every</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">+=</span> <span class="s">&#39; Data is sub-sampled to every &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sample_every</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; frames.&#39;</span>
    <span class="k">return</span> <span class="n">data_details_return</span><span class="p">({</span><span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">,</span> <span class="s">&#39;lbls&#39;</span> <span class="p">:</span> <span class="n">lbls</span><span class="p">,</span> <span class="s">&#39;Ytest&#39;</span><span class="p">:</span> <span class="n">Ytest</span><span class="p">,</span> <span class="s">&#39;lblstest&#39;</span> <span class="p">:</span> <span class="n">lblstest</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span> <span class="s">&#39;skel&#39;</span><span class="p">:</span> <span class="n">skel</span><span class="p">},</span> <span class="n">data_set</span><span class="p">)</span>
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">GPy  documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../GPy.html" >GPy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Author.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>